\documentclass[final]{siamart0216}

%% ------------------------------------------------------------------
%% Code used in examples, needed to reproduce 
%% ------------------------------------------------------------------
%% Used for \set, used in an example below
\usepackage{braket,amsfonts}

%% Used in table example below
\usepackage{array}

%% Used in table and figure examples below
\usepackage[caption=false]{subfig}

%% Used for PgfPlots example, shown in the "Figures" section below.
\usepackage{pgfplots}

%% Used for creating new theorems, remarks
\newsiamthm{claim}{Claim}
\newsiamremark{rem}{Remark}
\newsiamremark{expl}{Example}
\newsiamremark{hypothesis}{Hypothesis}
\crefname{hypothesis}{Hypothesis}{Hypotheses}

%% Algorithm style, could alternatively use algpseudocode
\usepackage{algorithmic}

%% For figures
\usepackage{graphicx,epstopdf}


%% For referencing line numbers
%\Crefname{ALC@unique}{Line}{Lines}

%% For creating math operators
\usepackage{amsopn}
\DeclareMathOperator{\Range}{Range}

%% ------------------------------------------------------------------
%% End Code used in examples, needed to reproduce 
%% ------------------------------------------------------------------


%% ------------------------------------------------------------------
%% Macros for in-document examples. These are not meant to reused for
%% SIAM journal papers.
%% ------------------------------------------------------------------
\include{pauls-macros}
\usepackage{xspace}
\usepackage{bold-extra}
\usepackage[most]{tcolorbox}
\newcommand{\BibTeX}{{\scshape Bib}\TeX\xspace}
\newcounter{example}
\colorlet{texcscolor}{blue!50!black}
\colorlet{texemcolor}{red!70!black}
\colorlet{texpreamble}{red!70!black}
\colorlet{codebackground}{black!25!white!25}

\newcommand\bs{\symbol{'134}} % print backslash in typewriter OT1/T1
\newcommand{\preamble}[2][\small]{\textcolor{texpreamble}{#1\texttt{#2 \emph{\% <- Preamble}}}}

\lstdefinestyle{siamlatex}{%
  style=tcblatex,
  texcsstyle=*\color{texcscolor},
  texcsstyle=[2]\color{texemcolor},
  keywordstyle=[2]\color{texemcolor},
  moretexcs={cref,Cref,maketitle,mathcal,text,headers,email,url},
}

\tcbset{%
  colframe=black!75!white!75,
  coltitle=white,
  colback=codebackground, % bottom/left side
  colbacklower=white, % top/right side
  fonttitle=\bfseries,
  arc=0pt,outer arc=0pt,
  top=1pt,bottom=1pt,left=1mm,right=1mm,middle=1mm,boxsep=1mm,
  leftrule=0.3mm,rightrule=0.3mm,toprule=0.3mm,bottomrule=0.3mm,
  listing options={style=siamlatex}
}

\newtcblisting[use counter=example]{example}[2][]{%
  title={Example~\thetcbcounter: #2},#1}

\newtcbinputlisting[use counter=example]{\examplefile}[3][]{%
  title={Example~\thetcbcounter: #2},listing file={#3},#1}

\DeclareTotalTCBox{\code}{ v O{} }
{ %fontupper=\ttfamily\color{texemcolor},
  fontupper=\ttfamily\color{black},
  nobeforeafter,
  tcbox raise base,
  colback=codebackground,colframe=white,
  top=0pt,bottom=0pt,left=0mm,right=0mm,
  leftrule=0pt,rightrule=0pt,toprule=0mm,bottomrule=0mm,
  boxsep=0.5mm,
  #2}{#1}

% Stretch the pages
\patchcmd\newpage{\vfil}{}{}{}
\flushbottom

%% ------------------------------------------------------------------
%% End of macros for in-document examples. 
%% ------------------------------------------------------------------

%% ------------------------------------------------------------------
%% HEADER
%% ------------------------------------------------------------------
\begin{tcbverbatimwrite}{tmp_\jobname_header.tex}
\title{Block QR Column Pivoting}

\author{Pranay Seshadri\thanks{Research Associate, Department of Engineering, University of Cambridge, Cambridge, CB2 1PZ, U.K., (\texttt{p.seshadri@eng.cam.ac.uk})}   }

% Custom SIAM macro to insert headers
\headers{Block QR Column Pivoting}
{Seshadri}
\end{tcbverbatimwrite}
\input{tmp_\jobname_header.tex}

% Optional: Set up PDF title and authors
\ifpdf
\hypersetup{ pdftitle={Guide to Using  SIAM'S \LaTeX\ Style} }
\fi

%% ------------------------------------------------------------------
%% END HEADER
%% ------------------------------------------------------------------

%% ------------------------------------------------------------------
%% MAIN Document
%% ------------------------------------------------------------------
\begin{document}
\maketitle

%% ------------------------------------------------------------------
%% ABSTRACT
%% ------------------------------------------------------------------
%\begin{tcbverbatimwrite}{tmp_\jobname_abstract.tex}
%
%
%\begin{abstract}
%Abstract goes here
%\end{abstract}
%
%\begin{keywords}
%  \LaTeX, \BibTeX, SIAM Journals, Documentation 
%\end{keywords}
%
%\begin{AMS}
%
%\end{AMS}
%\end{tcbverbatimwrite}
%\input{tmp_\jobname_abstract.tex}

\section{Outline}
The objective of this sketch is to offer some strategies for QR with column pivoting when the matrix $\mA$ is too large to store in memory. The idea is that we can generate $r<n$ columns of $\mA \in \mathbb{R}^{m \times n}$.  



\subsection{Notes from Guintana-Orti et al. }
The authors describe a new variant of the QRP algorithm that can employ Level 3 BLAS kernels. What seems to have kept the original QRP (Golub et al.) from using Level 3 BLAS kerneldes is the norm downdate scheme (step 4) -- at every step we must downdate all column norms before we can select the next pivot column among the remaining ones. The formula for the norm downdate we used is not obviously numerically reliable, and G.W. Stewart developed a robust scehe,. 

The normdowndate scheme has at least two noticeable features: (1) it makes the computation of column norms affordable and hence makes the column pivoting scheme practical, and (2) it governs the numerical aspects of the QRP procedure. Consulting Figure 1, we notice that in order to downdate the column norms after the jth step we need only to know the updated jth row. This allows us to choose the next pivot column, $p$. Next, to determine the next Householder transformation it is sufficient to apply the previous Householder transformations only to the pth column. The update of elements in other rows and columns can be delayed. This analysis underpins our block algorith: for every 
\begin{algorithm}
Given square matrices \texttt{A1} and \texttt{A2} of sizes \texttt{order1} and \texttt{order2} respectively,
\begin{enumerate}
\itemsep0em
\item Compute the QR factorization with column pivoting for \texttt{A1} and \texttt{A2}: \texttt{[Q1,R1,P1] = qr(A1)},  \texttt{[Q2,R2,P2] = qr(A2)};
\item Determine the size of \texttt{R1} and \texttt{R2}: \texttt{[rowsR2,colsR2] = size(R2)}, \texttt{[rowsR1,colsR1] = size(R1)};
\item Reshape the model evaluations at the quadrature points: \texttt{B = reshape(b, [order2, order1])};
\item Compute \texttt{K = Q2' * B * Q1};
\item Determine the submatrix \texttt{K11 = K(1:rowsR2, 1:colsR1)};
\item The least squares solution is then given by: \texttt{X = P2 * inv(R2) * K11 * inv(R1') * P1}.
\end{enumerate}
\caption{Large least squares on problems involving kronecker products}
\label{alg:0}
\end{algorithm}



\bibliographystyle{siamplain}
\bibliography{references}

\end{document}
